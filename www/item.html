<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Expense Tracker</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
  <link rel="stylesheet" href="css/styles.css">
  <link rel="stylesheet" href="css/item.css">
</head>
<body>

  <!-- Top Navigation Bar -->
  <nav class="navbar navbar-top">
    <div class="container-fluid">
      <span class="navbar-brand mb-0 h1">Expense</span>
      <div class="grey-stripe"></div>
    </div>
  </nav>
  
  <!-- Add Expense Box -->
  <div class="container item-box">
    <div class="row justify-content-center">
      <div class="col-6 curvy-box">
        <span>Add Expense</span>
        <br>
        <a href="addItem.html" class="add-item-circle"><span>+</span></a>
      </div>
    </div>
  </div>

  <!-- Expense List Container -->
  <div class="container expense-list-box">
    <div id="expense-list"></div>
  </div>

  <!-- Bottom Navigation Bar -->
  <nav class="navbar fixed-bottom navbar-light">
    <div class="container-fluid">
      <div class="d-flex justify-content-center w-100">
        <div class="nav-item">
          <a class="nav-link" href="home.html">
            <i class="bi bi-house"></i>
            <span>Home</span>
          </a>
        </div>

        <div class="nav-item">
          <a class="nav-link" href="item.html">
            <i class="bi bi-plus-circle"></i>
            <span>Item</span>
          </a>
        </div>

        <div class="nav-item">
          <a class="nav-link" href="#chart">
            <i class="bi bi-bar-chart"></i>
            <span>Chart</span>
          </a>
        </div>
      </div>
    </div>
  </nav>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const items = JSON.parse(localStorage.getItem('items')) || [];
      const expenseList = document.getElementById('expense-list');

      const groupedItems = items.reduce((acc, item) => {
        acc[item.date] = acc[item.date] || [];
        acc[item.date].push(item);
        return acc;
      }, {});

      const sortedDates = Object.keys(groupedItems).sort((a, b) => new Date(b) - new Date(a));

      sortedDates.forEach(date => {
        const dateHeader = document.createElement('h4');
        dateHeader.textContent = date;
        expenseList.appendChild(dateHeader);

        const expenseContainer = document.createElement('div');
        expenseContainer.classList.add('list-group');

        groupedItems[date].forEach(expense => {
          const expenseItem = document.createElement('a');
          expenseItem.href = `editItem.html?date=${encodeURIComponent(expense.date)}&name=${encodeURIComponent(expense.name)}`;
          expenseItem.classList.add('list-group-item', 'list-group-item-action', 'd-flex', 'justify-content-between', 'align-items-center');

          const categoryIcon = document.createElement('i');
          categoryIcon.className = getCategoryIcon(expense.category);

          const expenseInfo = document.createElement('div');
          expenseInfo.classList.add('d-flex', 'align-items-center');

          const categoryText = document.createElement('div');
          categoryText.classList.add('ms-3');
          categoryText.innerHTML = `<div class="fw-bold">${expense.category}</div><div>${expense.name}</div>`;

          const amount = document.createElement('span');
          amount.textContent = `$${expense.amount.toFixed(2)}`;

          expenseInfo.appendChild(categoryIcon);
          expenseInfo.appendChild(categoryText);
          expenseItem.appendChild(expenseInfo);
          expenseItem.appendChild(amount);

          expenseContainer.appendChild(expenseItem);
        });

        expenseList.appendChild(expenseContainer);
      });
    });

    function getCategoryIcon(category) {
      switch (category) {
        case 'Food':
          return 'bi bi-cup-straw';
        case 'Bills':
          return 'bi bi-receipt';
        case 'Transportation':
          return 'bi bi-truck';
        case 'Groceries':
          return 'bi bi-cart';
        case 'Entertainment':
          return 'bi bi-controller';
        default:
          return 'bi bi-tags';
      }
    }
  </script>

</body>
</html>
